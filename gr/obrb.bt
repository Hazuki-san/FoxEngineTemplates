#include "../common/common.bt"
#include "gr_common.bt"

GrHeader Header;

FSeek(Header.MetadataEntriesOffset);

GrMetadataEntries MetadataEntries;

#define ObjectBrushBlockMetadata MetadataEntries.Entry[0]
#define NumObjects ObjectBrushBlockMetadata.Param[GetGrMetadataEntryParamIndex(ObjectBrushBlockMetadata, "numObjects")].Value

FSeek(startof(ObjectBrushBlockMetadata) + ObjectBrushBlockMetadata.DataOffset);

struct Object
{
    float YPositionFWS;
	short XPositionEFOS;
	short ZPositionEFOS;
    HQuaternion Rotation;
    ushort BlockIndex;
    ubyte PluginBrushIndex; // Index of ObjBrush dataset entity's pluginHandle list entry
    ubyte NormalizedScale; // scale = lerp(minScale, maxScale, NormalizedScale) found in DataSet plugin definition
    uint GlobalObjectIndex;
} Objects[NumObjects] <read = Str("plugin: %d, block: %d, globalIndex: %d", PluginBrushIndex, BlockIndex, GlobalObjectIndex), bgcolor = 0x8CAF5A>;